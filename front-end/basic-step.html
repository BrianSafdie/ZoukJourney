<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Basic Step – Video</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <style>
    .disabled-btn {
      background-color: #ccc;
      color: #666;
      cursor: not-allowed;
    }

    .status-msg {
      margin: 20px 0;      font-weight: bold;    }

    .btn {
      padding: 12px 24px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background-color: #333;
      color: white;
      transition: 0.3s;}

    .btn:hover:enabled {background-color: #555;}
    .hidden-body {display: none;}
    
  </style>
</head>
<body class="hidden-body">
  <script>
  // const userName = localStorage.getItem("userName");
  // if (!userName) {
  //   // המשתמש לא מחובר – מעבירים לעמוד ההתחברות
  //   window.location.href = "index.html";
  // }

  </script>

  <div class="container">
    <p id="greeting"></p>

    <h1>Basic Step – Lesson</h1>
    <p>In this lesson, you’ll learn the foundational movement of Brazilian Zouk: the Basic Step. Watch the video to understand rhythm, weight changes, and body coordination.</p>
    <p>Watch the video. Once you've watched 85% of it, you'll be able to take the quiz.</p>

    <div class="video-wrapper">
      <iframe
        id="lesson-video"
        src="https://www.youtube.com/embed/tCDvOQI3pco?enablejsapi=1"
        frameborder="0"
        allow="autoplay; encrypted-media"
        allowfullscreen>
      </iframe>
    </div>

    <p id="video-status" class="status-msg">Progress: 0%</p>

    <button id="go-to-quiz-btn" class="btn disabled-btn" disabled>
      🔒 Go to Quiz
    </button>
  </div>

  <script>
    let player;

    function onYouTubeIframeAPIReady() {
      player = new YT.Player("lesson-video", {
        events: {
          onReady: trackVideoProgress
        }
      });
    }

    function trackVideoProgress() {
      setInterval(() => {
        if (!player || !player.getDuration || !player.getCurrentTime) return;

        const duration = player.getDuration();
        const current = player.getCurrentTime();
        const percent = Math.floor((current / duration) * 100);

        document.getElementById("video-status").innerText = `Progress: ${percent}%`;

        if (percent >= 85) {
          const btn = document.getElementById("go-to-quiz-btn");
          btn.disabled = false;
          btn.classList.remove("disabled-btn");
          btn.innerText = "✅ Go to Quiz";
          btn.onclick = () => {
            window.location.href = "basic-step-quiz.html";
          };
        }
      }, 1000);
    }

    // Load YouTube API
    const tag = document.createElement("script");
    tag.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(tag);
    
  </script>
  <script src="auth.js"></script>

</body>
</html>
